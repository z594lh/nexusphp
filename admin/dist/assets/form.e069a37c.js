var I=Object.defineProperty,S=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var H=(t,e,i)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,E=(t,e)=>{for(var i in e||(e={}))A.call(e,i)&&H(t,i,e[i]);if(C)for(var i of C(e))$.call(e,i)&&H(t,i,e[i]);return t},B=(t,e)=>S(t,R(e));import{_ as F,s as G,l as L,v as O,u as P,r as W,B as z,o as J,a as b,x as K,t as Q,b as m,d as c,e as h,f as a,w as o,C as Y,E as X,F as k,k as q,h as u,m as T,j as N,i as w,y as Z}from"./index.dabb5305.js";const ee={name:"ExamForm",setup(){const{proxy:t}=G();console.log("proxy",t);const e=L(null),i=O(),v=P(),{id:p}=i.query,n=W({token:z("token")||"",id:p,allClasses:[],formData:{name:"",description:"",begin:"",end:"",duration:"",indexes:[],filters:{classes:[],register_time_range:[],donate_status:[]},status:"",is_discovered:"",priority:""},rules:{name:[{required:"true"}],indexes:[{required:"true"}],status:[{required:"true"}],is_discovered:[{required:"true"}]}});J(async()=>{await V(),await D(),p&&b.getExam(p).then(r=>{n.formData.name=r.data.name,n.formData.description=r.data.description,n.formData.begin=r.data.begin,n.formData.end=r.data.end,n.formData.duration=r.data.duration,n.formData.indexes=r.data.indexes,n.formData.filters=r.data.filters,n.formData.status=r.data.status,n.formData.is_discovered=r.data.is_discovered,n.formData.priority=r.data.priority})}),K(()=>{});const f=()=>{e.value.validate(async r=>{if(r){let s=n.formData;console.log(s),s.begin&&(s.begin=Y(s.begin).format("YYYY-MM-DD HH:mm:ss")),s.end&&(s.end=Y(s.end).format("YYYY-MM-DD HH:mm:ss")),s.filters.register_time_range&&s.filters.register_time_range[0]&&(s.filters.register_time_range[0]=Y(s.filters.register_time_range[0]).format("YYYY-MM-DD HH:mm:ss")),s.filters.register_time_range&&s.filters.register_time_range[1]&&(s.filters.register_time_range[1]=Y(s.filters.register_time_range[1]).format("YYYY-MM-DD HH:mm:ss")),console.log(s),p?await b.updateExam(p,s):await b.storeExam(s),await v.push({name:"exam"})}})},d=r=>{const s=r.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(s))return X.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},_=r=>{n.formData.goodsCoverImg=r.data||""},g=r=>{n.categoryId=r[2]||0},V=async()=>{let r=await b.listClass();n.allClasses=r.data},D=async()=>{let r=await b.listExamIndex();n.formData.indexes=r.data};return B(E({},Q(n)),{formRef:e,submitAdd:f,handleBeforeUpload:d,handleUrlSuccess:_,handleChangeCate:g})}},ae=u("Enabled"),te=u("Disabled"),le=u("No"),oe=u("Yes"),re=T("div",{style:{color:"#aaa"}},"The higher the value, the higher the priority, and when multiple exam match the same user, the one with the highest priority is assigned.",-1),se=T("div",{style:{color:"#aaa"}},"Unit: days. When assign to user, begin and end are used if they are specified. Otherwise begin time is the time at assignment, and the end time is the time at assignment plus the duration.",-1),ne=u("No"),de=u("Yes"),ie=u("Submit");function me(t,e,i,v,p,n){const f=m("el-input"),d=m("el-form-item"),_=m("el-checkbox"),g=m("el-col"),V=m("el-row"),D=m("el-radio"),r=m("el-radio-group"),s=m("el-date-picker"),M=m("el-checkbox-group"),j=m("el-button"),x=m("el-form");return c(),h("div",null,[a(V,null,{default:o(()=>[a(g,{span:12},{default:o(()=>[a(x,{model:t.formData,rules:t.rules,ref:"formRef","label-width":"200px",class:"formData"},{default:o(()=>[a(d,{label:"Name",prop:"name"},{default:o(()=>[a(f,{modelValue:t.formData.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.formData.name=l),placeholder:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Index",prop:"indexes"},{default:o(()=>[(c(!0),h(k,null,q(t.formData.indexes,(l,y)=>(c(),N(V,{key:y,style:{width:"100%"}},{default:o(()=>[a(g,{span:6},{default:o(()=>[a(_,{modelValue:l.checked,"onUpdate:modelValue":U=>l.checked=U,label:l.checked},{default:o(()=>[u(w(l.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(g,{span:12},{default:o(()=>[a(f,{type:"number",modelValue:l.require_value,"onUpdate:modelValue":U=>l.require_value=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(g,{span:6,style:{padding:"0 20px",color:"#aaa"}},{default:o(()=>[l.unit?(c(),h(k,{key:0},[u(" Unit: "+w(l.unit),1)],64)):Z("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(d,{label:"Status",prop:"status"},{default:o(()=>[a(r,{modelValue:t.formData.status,"onUpdate:modelValue":e[1]||(e[1]=l=>t.formData.status=l)},{default:o(()=>[a(D,{label:0},{default:o(()=>[ae]),_:1}),a(D,{label:1},{default:o(()=>[te]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Discovered",prop:"is_discovered"},{default:o(()=>[a(r,{modelValue:t.formData.is_discovered,"onUpdate:modelValue":e[2]||(e[2]=l=>t.formData.is_discovered=l)},{default:o(()=>[a(D,{label:0},{default:o(()=>[le]),_:1}),a(D,{label:1},{default:o(()=>[oe]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Priority",prop:"priority"},{default:o(()=>[a(f,{modelValue:t.formData.priority,"onUpdate:modelValue":e[3]||(e[3]=l=>t.formData.priority=l),type:"number",placeholder:""},null,8,["modelValue"]),re]),_:1}),a(d,{label:"Begin",prop:"begin"},{default:o(()=>[a(s,{modelValue:t.formData.begin,"onUpdate:modelValue":e[4]||(e[4]=l=>t.formData.begin=l),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Begin Time"},null,8,["modelValue"])]),_:1}),a(d,{label:"End",prop:"end"},{default:o(()=>[a(s,{modelValue:t.formData.end,"onUpdate:modelValue":e[5]||(e[5]=l=>t.formData.end=l),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select End Time"},null,8,["modelValue"])]),_:1}),a(d,{label:"Duration",prop:"duration"},{default:o(()=>[a(f,{modelValue:t.formData.duration,"onUpdate:modelValue":e[6]||(e[6]=l=>t.formData.duration=l),type:"number",placeholder:""},null,8,["modelValue"]),se]),_:1}),a(d,{label:"Target user class",prop:"filters.classes"},{default:o(()=>[a(M,{modelValue:t.formData.filters.classes,"onUpdate:modelValue":e[7]||(e[7]=l=>t.formData.filters.classes=l)},{default:o(()=>[(c(!0),h(k,null,q(t.allClasses,(l,y)=>(c(),N(_,{label:y,key:y},{default:o(()=>[u(w(l),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Target user donated",prop:"filters.donate_status"},{default:o(()=>[a(M,{modelValue:t.formData.filters.donate_status,"onUpdate:modelValue":e[8]||(e[8]=l=>t.formData.filters.donate_status=l)},{default:o(()=>[a(_,{label:"no"},{default:o(()=>[ne]),_:1}),a(_,{label:"yes"},{default:o(()=>[de]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Target user register time"},{default:o(()=>[a(s,{modelValue:t.formData.filters.register_time_range,"onUpdate:modelValue":e[9]||(e[9]=l=>t.formData.filters.register_time_range=l),type:"datetimerange",format:"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Begin","end-placeholder":"End"},null,8,["modelValue"])]),_:1}),a(d,{label:"Description",prop:"description"},{default:o(()=>[a(f,{type:"textarea",modelValue:t.formData.description,"onUpdate:modelValue":e[10]||(e[10]=l=>t.formData.description=l),placeholder:""},null,8,["modelValue"])]),_:1}),a(d,null,{default:o(()=>[a(j,{type:"primary",onClick:e[11]||(e[11]=l=>v.submitAdd())},{default:o(()=>[ie]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})])}var pe=F(ee,[["render",me]]);export{pe as default};
