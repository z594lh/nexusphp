var I=Object.defineProperty,N=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var B=(l,o,t)=>o in l?I(l,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[o]=t,U=(l,o)=>{for(var t in o||(o={}))P.call(o,t)&&B(l,t,o[t]);if(A)for(var t of A(o))z.call(o,t)&&B(l,t,o[t]);return l},T=(l,o)=>N(l,R(o));import{_ as F,l as j,u as M,r as L,o as Q,a as h,t as Y,b as i,c as G,d as y,j as E,w as n,E as g,m as v,f as a,e as H,k as J,F as K,g as O,h as C,z as W,A as X}from"./index.dabb5305.js";import{u as Z,r as $,a as ee}from"./table.6af03a03.js";const ae={name:"ExamUserTable",setup(){const l=j(null),o=M(),t=Z();let r=L({exams:[]});Q(()=>{h.listExamAll().then(e=>{r.exams=e.data}),u()});const u=async()=>{t.loading=!0;let e=await h.listExamUser(t.query);$(e,t),t.loading=!1},V=()=>{o.push({name:"user-form"})},p=e=>{o.push({name:"user-form",query:{id:e}})},b=async e=>{let m=await h.deleteExam(e);g.success(m.msg),t.query.page=1,await u()},_=async()=>{let e=t.multipleSelection.map(D=>D.id);if(e.length==0){g.error("No data selected !");return}console.log(e);let m=await h.avoidExamUserBulk({id:e});g.success(m.msg),t.query.page=1,await u()},c=async()=>{let e=t.multipleSelection.map(D=>D.id);if(e.length==0){g.error("No data selected !");return}console.log(e);let m=await h.deleteExamUserBulk({id:e});g.success(m.msg),t.query.page=1,await u()},f=e=>{t.multipleSelection=e},x=e=>{t.query.page=e,u()},d=e=>{ee(e,t),u()},k=e=>{o.push({name:"user-detail",query:{id:e}})},w=(e,m)=>e.user.username,q=(e,m)=>e.exam.name,S=(e,m)=>e.downloaded_text,s=()=>{t.query.is_done="",t.query.status="",t.query.exam_id=""};return T(U({},Y(t)),{multipleTable:l,extraData:r,handleSelectionChange:f,handleAdd:V,handleEdit:p,handleDelete:b,handleDetail:k,handleAvoidBulk:_,handleDeleteBulk:c,fetchTableData:u,changePage:x,handleSortChange:d,formatColumnUser:w,formatColumnExam:q,formatColumnDownloaded:S,handleReset:s})}},le=l=>(W("data-v-d2c322e8"),l=l(),X(),l),te={class:"nexus-table-header"},oe={class:"left"},ne=C("Remove"),re=C("Avoid"),se=C("Query"),de=C("Reset"),ie=le(()=>v("div",{class:"right"},null,-1)),ue=["onClick"];function ce(l,o,t,r,u,V){const p=i("el-button"),b=i("el-popconfirm"),_=i("el-form-item"),c=i("el-option"),f=i("el-select"),x=i("el-form"),d=i("el-table-column"),k=i("el-table"),w=i("el-pagination"),q=i("el-card"),S=G("loading");return y(),E(q,null,{header:n(()=>[v("div",te,[v("div",oe,[a(x,{inline:!0,model:l.query},{default:n(()=>[a(_,null,{default:n(()=>[a(b,{title:"Confirm Remove ?",onConfirm:r.handleDeleteBulk},{reference:n(()=>[a(p,{type:"default"},{default:n(()=>[ne]),_:1})]),_:1},8,["onConfirm"]),a(b,{title:"Confirm Avoid ?",onConfirm:r.handleAvoidBulk},{reference:n(()=>[a(p,{type:"default"},{default:n(()=>[re]),_:1})]),_:1},8,["onConfirm"])]),_:1}),a(_,{label:""},{default:n(()=>[a(f,{modelValue:l.query.exam_id,"onUpdate:modelValue":o[0]||(o[0]=s=>l.query.exam_id=s),filterable:"",placeholder:"Exam",clearable:""},{default:n(()=>[(y(!0),H(K,null,J(r.extraData.exams,s=>(y(),E(c,{key:s.id,label:s.name,value:s.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(_,{label:""},{default:n(()=>[a(f,{modelValue:l.query.is_done,"onUpdate:modelValue":o[1]||(o[1]=s=>l.query.is_done=s),filterable:"",placeholder:"IsDone",clearable:""},{default:n(()=>[a(c,{label:"Yes",value:"1"}),a(c,{label:"No",value:"0"})]),_:1},8,["modelValue"])]),_:1}),a(_,{label:""},{default:n(()=>[a(f,{modelValue:l.query.status,"onUpdate:modelValue":o[2]||(o[2]=s=>l.query.status=s),filterable:"",placeholder:"Status",clearable:""},{default:n(()=>[a(c,{label:"Avoided",value:"-1"}),a(c,{label:"Normal",value:"0"}),a(c,{label:"Finished",value:"1"})]),_:1},8,["modelValue"])]),_:1}),a(_,null,{default:n(()=>[a(p,{type:"primary",onClick:r.fetchTableData},{default:n(()=>[se]),_:1},8,["onClick"]),a(p,{type:"primary",onClick:r.handleReset},{default:n(()=>[de]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),ie])]),default:n(()=>[O((y(),E(k,{ref:"multipleTable",data:l.tableData,"tooltip-effect":"dark",onSortChange:r.handleSortChange,onSelectionChange:r.handleSelectionChange},{default:n(()=>[a(d,{type:"selection",width:"55"}),a(d,{prop:"id",label:"Id",width:"100",sortable:"custom"}),a(d,{prop:"exam_id",label:"Exam",formatter:r.formatColumnExam},null,8,["formatter"]),a(d,{prop:"uid",label:"User",formatter:r.formatColumnUser},null,8,["formatter"]),a(d,{prop:"is_done_text",label:"Is done"}),a(d,{prop:"status_text",label:"Status"}),a(d,{prop:"created_at",label:"Created At"}),a(d,{label:"Action",width:"100"},{default:n(s=>[v("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:e=>r.handleDetail(s.row.uid)},"Detail",8,ue)]),_:1})]),_:1},8,["data","onSortChange","onSelectionChange"])),[[S,l.loading]]),a(w,{background:"",layout:"prev, pager, next",total:l.total,"page-size":l.perPage,"current-page":l.currentPage,onCurrentChange:r.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var fe=F(ae,[["render",ce],["__scopeId","data-v-d2c322e8"]]);export{fe as default};
